{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import { Video, Channel, Playlist, YTComment } from './entities'\nimport { parseUrl, request } from './util'\nimport { Cache } from './util/caching'\nimport { OAuth } from './oauth'\nexport * from './entities'\nexport * from './types'\n\n/**\n * The main class used to interact with the YouTube API. Use this.\n */\nexport class YouTube {\n  private _shouldCache: boolean\n  private _cacheSearches: boolean\n  private _cacheTTL: number\n  private _token: string\n\n  get token (): string {\n    return this._token\n  }\n  set token (val: string) {\n    this._token = val\n    this.tokenType = val.startsWith('ya29') ? 'oauth' : 'key'\n  }\n\n  public tokenType: 'key' | 'oauth'\n\n  public oauth: OAuth\n\n  /**\n   *\n   * @param token Your YouTube Data API v3 token. Don't share this with anybody.\n   * It could be an API key or an OAuth 2.0 token.\n   * @param options Caching options. Recommended to change.\n   */\n  constructor (token: string, options: YouTubeOptions = { cache: true, cacheTTL: 600, cacheCheckInterval: 600, cacheSearches: false }) {\n    this.token = token\n\n    this.oauth = new OAuth(this)\n\n    this._shouldCache = options.cache\n    this._cacheSearches = options.cacheSearches\n    this._cacheTTL = options.cacheTTL\n\n    if (options.cacheCheckInterval > 0) {\n      setInterval(Cache.checkTTLs, options.cacheCheckInterval * 1000)\n    }\n  }\n\n  public _cache (id: string, value: any) {\n    if (!this._shouldCache) {\n      return\n    }\n\n    Cache.set(id, value, this._cacheTTL > 0 ? this._cacheTTL * 1000 + new Date().getTime() : 0)\n  }\n\n  /**\n   * Search videos on YouTube.\n   * @param searchTerm What to search for on YouTube.\n   * @param maxResults The maximum amount of results to find. Defaults to 10.\n   */\n  public searchVideos (searchTerm: string, maxResults: number = 10) {\n    return this.search(Video, searchTerm, maxResults) as Promise<Video[]>\n  }\n\n  /**\n   * Search channels on YouTube.\n   * @param searchTerm What to search for on YouTube.\n   * @param maxResults The maximum amount of results to find. Defaults to 10.\n   */\n  public searchChannels (searchTerm: string, maxResults: number = 10) {\n    return this.search(Channel, searchTerm, maxResults) as Promise<Channel[]>\n  }\n\n  /**\n   * Search playlists on YouTube.\n   * @param searchTerm What to search for on YouTube.\n   * @param maxResults The maximum amount of results to find. Defaults to 10.\n   */\n  public searchPlaylists (searchTerm: string, maxResults: number = 10) {\n    return this.search(Playlist, searchTerm, maxResults) as Promise<Playlist[]>\n  }\n\n  /**\n   * Get a video object from the ID of a video.\n   * @param id The ID of the video.\n   */\n  public getVideo (id: string) {\n    return this.getItemById(Video, id) as Promise<Video>\n  }\n\n  /**\n   * Get a channel object from the ID of a channel.\n   * @param id The ID of the channel.\n   */\n  public getChannel (id: string) {\n    return this.getItemById(Channel, id) as Promise<Channel>\n  }\n\n  /**\n   * Get a playlist object from the ID of a playlist.\n   * @param id The ID of the playlist.\n   */\n  public getPlaylist (id: string) {\n    return this.getItemById(Playlist, id) as Promise<Playlist>\n  }\n\n  /**\n   * Get a comment object from the ID of a comment.\n   * @param id The ID of the comment.\n   */\n  public getComment (id: string) {\n    return this.getItemById(YTComment, id) as Promise<YTComment>\n  }\n\n  /**\n   * Get a video object from the url of a video.\n   * @param url The url of the video.\n   */\n  public getVideoByUrl (url: string) {\n    const id = parseUrl(url)\n\n    if (!id.video) {\n      return Promise.reject('Not a valid video url')\n    }\n\n    return this.getItemById(Video, id.video) as Promise<Video>\n  }\n\n  /**\n   * Get a channel object from the url of a channel.\n   * @param url The url of the channel.\n   */\n  public getChannelByUrl (url: string) {\n    const id = parseUrl(url)\n\n    if (!id.channel) {\n      return Promise.reject('Not a valid channel url')\n    }\n\n    return this.getItemById(Channel, id.channel) as Promise<Channel>\n  }\n\n  /**\n   * Get a playlist object from the url of a playlist.\n   * @param url The url of the playlist.\n   */\n  public getPlaylistByUrl (url: string) {\n    const id = parseUrl(url)\n\n    if (!id.playlist) {\n      return Promise.reject('Not a valid playlist url')\n    }\n\n    return this.getItemById(Playlist, id.playlist) as Promise<Playlist>\n  }\n\n  /**\n   * Get `maxResults` videos in a playlist. Used mostly internally with `Playlist#fetchVideos`.\n   * @param playlistId The ID of the playlist.\n   * @param maxResults The maximum amount of videos to get from the playlist. If <= 0 or not included, returns all videos in the playlist.\n   */\n  public getPlaylistItems (playlistId: string, maxResults: number = -1) {\n    return this.getPaginatedItems('playlistItems', playlistId, maxResults) as Promise<Video[]>\n  }\n\n  /**\n   * Get `maxResults` comments from a video. Used mostly internally with `Video#fetchComments`.\n   * @param videoId The ID of the video.\n   * @param maxResults The maximum amount of comments to get from the video. If <= 0 or not included, returns all comments on the video.\n   */\n  public getVideoComments (videoId: string, maxResults: number = -1) {\n    return this.getPaginatedItems('commentThreads:video', videoId, maxResults) as Promise<YTComment[]>\n  }\n\n  /**\n   * Get `maxResults` comments from a channel's discussion tab. Used mostly internally with `Channel#fetchComments`.\n   * @param channelId The ID of the channel.\n   * @param maxResults The maximum amount of comments to get from the channel. If <= 0 or not included, returns all comments on the channel.\n   */\n  public getChannelComments (channelId: string, maxResults: number = -1) {\n    return this.getPaginatedItems('commentThreads:channel', channelId, maxResults) as Promise<YTComment[]>\n  }\n\n  /**\n   * Get `maxResults` replies to a comment. Used mostly internally with `Comment#fetchReplies`.\n   * @param commentId The ID of the comment to get replies from.\n   * @param maxResults The maximum amount of replies to get. Gets all replies if <= 0 or not included.\n   */\n  public getCommentReplies (commentId: string, maxResults: number = -1) {\n    return this.getPaginatedItems('comments', commentId, maxResults) as Promise<YTComment[]>\n  }\n\n  /* istanbul ignore next */\n  private async search (type: typeof Video | typeof Channel | typeof Playlist, searchTerm: string, maxResults: number = 10): Promise<Video[] | Channel[] | Playlist[]> {\n    const cached = Cache.get(`search://${type.endpoint}/\"${searchTerm}\"/${maxResults}`)\n\n    if (this._shouldCache && cached) {\n      return cached\n    }\n\n    if (maxResults < 1 || maxResults > 50) {\n      return Promise.reject('Max results must be greater than 0 and less than or equal to 50')\n    }\n\n    const results = await request.api('search', {\n      q: encodeURIComponent(searchTerm),\n      maxResults,\n      part: 'snippet',\n      type: type.endpoint.substring(0, type.endpoint.length - 1)\n    }, this.token, this.tokenType)\n\n    const items = []\n\n    results.items.forEach(item => {\n      items.push(new type(this, item))\n    })\n\n    if (this._shouldCache && this._cacheSearches) {\n      this._cache(`search://${type.endpoint}/\"${searchTerm}\"/${maxResults}`, items)\n    }\n\n    return items\n  }\n\n  /* istanbul ignore next */\n  private async getItemById (type: typeof Video | typeof Channel | typeof Playlist | typeof YTComment, id: string): Promise<Video | Channel | Playlist | YTComment> {\n    if (!([ Video, Channel, Playlist, YTComment ].includes(type))) {\n      return Promise.reject('Type must be a video, channel, playlist, or comment.')\n    }\n\n    const cached = Cache.get(`get://${type.endpoint}/${id}`)\n\n    if (this._shouldCache && cached) {\n      return cached\n    }\n\n    const result = await request.api(type.endpoint, { id, part: type.part }, this.token, this.tokenType)\n\n    if (result.items.length === 0) {\n      return Promise.reject('Item not found')\n    }\n\n    let endResult: Video | Playlist | Channel | YTComment = new type(this, result.items[0], result.items[0].snippet.channelId ? 'channel' : 'video')\n\n    if (this._shouldCache) {\n      this._cache(`get://${type.endpoint}/${id}`, endResult)\n    }\n\n    return endResult\n  }\n\n  /* istanbul ignore next */\n  private async getPaginatedItems (endpoint: 'playlistItems' | 'commentThreads' | 'commentThreads:video' | 'commentThreads:channel' | 'comments',\n                                    id: string, maxResults: number = -1): Promise<Video[] | YTComment[]> {\n    const cached = Cache.get(`get://${endpoint}/${id}/${maxResults}`)\n\n    if (this._shouldCache && cached) {\n      return cached\n    }\n\n    let full: boolean\n    let items = []\n\n    if (maxResults <= 0) {\n      full = true\n    } else {\n      full = false\n    }\n\n    const options: {\n      part: string,\n      maxResults: number,\n      videoId?: string,\n      parentId?: string,\n      textFormat?: string,\n      playlistId?: string,\n      pageToken?: string\n    } = {\n      part: 'snippet',\n      maxResults: 0\n    }\n\n    let max: number\n    let clazz: typeof Video | typeof YTComment\n    let commentType: 'video' | 'channel'\n\n    if (endpoint === 'playlistItems') {\n      max = 50\n      clazz = Video\n      options.playlistId = id\n    } else if (endpoint.startsWith('commentThreads')) {\n      max = 100\n      clazz = YTComment\n\n      const [, type ] = endpoint.split(':') as ('video' | 'channel')[]\n\n      commentType = type ? type : 'video'\n      endpoint = 'commentThreads'\n      options[`${type}Id`] = id\n      options.part += ',replies'\n      options.textFormat = 'plainText'\n    } else if (endpoint === 'comments') {\n      max = 100\n      clazz = YTComment\n      options.parentId = id\n    } else {\n      return Promise.reject('Unknown item type ' + endpoint)\n    }\n\n    if (maxResults > max) {\n      return Promise.reject(`Max results must be ${max} or below for ${endpoint}`)\n    }\n\n    options.maxResults = full ? max : maxResults\n\n    let results\n    let pages = null\n    let shouldReturn = !full\n\n    for (let i = 1; i < pages ? pages : 3; i++) {\n      results = await request.api(endpoint, options, this.token, this.tokenType).catch(() => {\n        return Promise.reject('Items not found')\n      })\n\n      if (results.items.length === 0) {\n        return Promise.reject('Items not found')\n      }\n\n      if (!pages) {\n        pages = results.pageInfo.totalResults / results.pageInfo.resultsPerPage\n\n        if (pages <= 1) {\n          shouldReturn = true\n        }\n\n        pages = Math.floor(pages)\n      }\n\n      results.items.forEach(item => {\n        let comment: YTComment\n\n        if (item.snippet.topLevelComment) {\n          comment = new YTComment(this, item.snippet.topLevelComment, commentType)\n          items.push(comment)\n        } else {\n          items.push(new clazz(this, item, commentType))\n        }\n\n        if (item.replies) {\n          item.replies.comments.forEach(reply => {\n            const created = new YTComment(this, reply, commentType)\n            comment.replies.push(created)\n          })\n        }\n      })\n\n      if (results.nextPageToken && !shouldReturn) {\n        options.pageToken = results.nextPageToken\n      } else {\n        return items\n      }\n    }\n\n    if (this._shouldCache) {\n      this._cache(`get://${endpoint}/${id}/${maxResults}`, items)\n    }\n\n    return items\n  }\n}\n\ntype YouTubeOptions = {\n  /**\n   * Whether or not to cache entities.\n   */\n  cache?: boolean\n\n  /**\n   * How long to cache entities in seconds (0 = unlimited).\n   */\n  cacheTTL?: number\n\n  /**\n   * How often to check for and delete expired cached items in seconds.\n   */\n  cacheCheckInterval?: number\n\n  /**\n   * Whether or not we should cache searches\n   */\n  cacheSearches?: boolean\n}\n\nexport default YouTube\n"],"sourceRoot":"../src"}